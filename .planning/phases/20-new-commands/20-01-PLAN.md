# Plan: 20-01 New Workflow Commands

## Objective

Add three missing workflow commands to complete the development toolkit: undo (granular reversal), compare (version analysis), and snapshot (state preservation).

## Execution Context

**Phase:** 20 - new-commands
**Plan:** 1 of 1
**Depends on:** Phase 19 complete

## Context

### Current State
- 40 existing GYWD commands
- Rollback exists but is full-phase level
- No granular undo capability
- No version comparison tool
- No explicit snapshot mechanism

### Target Outcomes
- `/gywd:undo` - Revert last operation or specific action
- `/gywd:compare` - Compare versions, branches, or phases
- `/gywd:snapshot` - Create named checkpoint for recovery

## Tasks

<task id="1" title="Create undo command">
Create `commands/gywd/undo.md`:

Key features:
- Undo last git commit (soft reset)
- Undo last file change (restore from git)
- Undo last plan execution (revert commits)
- Preview mode (show what would be undone)
- Scope options: --last, --commit <sha>, --file <path>
</task>

<task id="2" title="Create compare command">
Create `commands/gywd/compare.md`:

Key features:
- Compare two commits
- Compare current vs. branch
- Compare two phases (diff summaries)
- Compare specification vs. implementation
- Output formats: summary, detailed, diff
</task>

<task id="3" title="Create snapshot command">
Create `commands/gywd/snapshot.md`:

Key features:
- Create named checkpoint (git tag + metadata)
- List existing snapshots
- Restore from snapshot
- Auto-snapshot before risky operations
- Describe snapshots with context
</task>

<task id="4" title="Add tests for new commands">
Create integration tests validating command specs are well-formed.
</task>

## Success Criteria

- [ ] undo.md follows command spec format
- [ ] compare.md follows command spec format
- [ ] snapshot.md follows command spec format
- [ ] All existing tests pass
- [ ] Commands registered in .claude-plugin/plugin.json
